var friends=new function(){function e(e){addTitleBar(["mob1.friends","Friends"],"",null,e?a?["mob1.done","Done"]:["mob1.edit","Edit"]:"",e?i:null)}function t(t){e(t)}function i(){a=!a,Obj={Command:"EditChange"},Obj.OnOff=a?"On":"Off",ToC(Obj),e(1)}function n(){var e=clearDiv("idfriends");makeElement(e,"div","","0")}this.ScrollContainer=document.getElementById("ScrollContainer");var a=!1;this.main=function(t){xatMain(t),e(1),document.body.style.display="block",debug("fake"),this.ScrollContainer.style.top=document.getElementById("titleBar").clientHeight+document.getElementById("topSelector").clientHeight,this.ScrollContainer.style.bottom=0,this.ScrollContainer.addEventListener("scroll",onScrollEventHandler,!1),doZap(10),LoadLang({mob1:0})},this.addHelpMessage=function(e){var t=document.getElementById("idfriends");t&&t.appendChild(MakeHelpMessage(e))},this.sendApp=function(e,i,n,d){e.target;e.stopPropagation();var l;if(null!==i&&"object"==typeof i)switch(i.Type){case"swiperight":if(!(d=i.id))return;i=d.substring(7);break;default:return}switch(i){case"Friends":a=!1;case"Contacts":(l={Page:"friends",Command:"friends"+i}).Type=l.Command,t("Friends"==i?1:0);break;default:if(0==i)return;l=d?{UserNo:i,Page:"friends",Command:"Action",name:"Unfriend"}:{UserNo:i,Page:"friends",Command:"Click",Next:"messages",Name:n}}ToC(l)},this.SetEdit=function(e){var t,i=document.getElementsByClassName("EditCell"),n="1"==e;for(t=0;t<i.length;t++){var a=i[t];if(a.innerHTML="",n){var d=makeElement(a,"img");d.height=24,d.src="svg/deleteicon.svg",a.onclick=function(e){friends.sendApp(e,this.id.substring(3),0,"del")}}}},this.addSection=function(e){n();document.getElementById("idfriends");SetSection(e)},this.addFriend=function(e,t){var i=JSON.parse(e),n=i.id;if(0!=n){var a,d,l,o="",s=FriendsContacts=i.list,r=s+n,m=document.getElementById("idfriends");if(m){removeById(r);var c=makeElement(null,"li","friend");iidLine++,c.setAttribute("data-line",iidLine),LineVisible=0,c.setAttribute("data-visible",LineVisible),c.id=r,AddHammer(c,Hammer.DIRECTION_RIGHT);var f=makeElement(c,"div","listTable"),g=makeElement(f,"div","dialogRow");makeElement(g,"div","dialogCell dialogCellMiddle EditCell","del"+n),this.Classic||(l=makeElement(g,"div","dialogCell dialogCellMiddle"));var v=makeElement(g,"div","dialogCell dialogWide noPointer"),p=makeElement(v,"div","");makeElement(v,"div","");var u=makeElement(g,"div","dialogCell dialogCellMiddle");d=makeElement(u,"div","conimg","arw"+n),l&&LoadImage(l,i.image,"avatar",30,i),void 0!=(a=ProcessName(i.name,o,65535)).status&&(o=a.status);var C=makeElement(p,"p");C.className="friendsName";var h=createSmText(i.pawn+a.name);if(void 0!==a.glow&&(h.style["text-shadow"]=MakeGlow(a.glow)),void 0!==a.col&&(h.style.color="#"+toHex6(a.col)),C.appendChild(h),!this.Classic){var E=makeElement(p,"p");if(E.className="friendsStatus",o){var k=document.createTextNode(o);void 0!==a.statusglow&&(E.style["text-shadow"]=MakeGlow(a.statusglow)),void 0!==a.statuscol&&(E.style.color="#"+toHex6(a.statuscol)),E.appendChild(k)}var b=createSmText(i.text);E.appendChild(b),d.innerHTML="";var w=makeElement(d,"img","conimg"),y=!1;switch(i.pawn){case"(p1pwn#00c100)":y="arrowgreen";break;case"(p1pwn#ff5800)":y="arroworange";break;case"(p1pwn#ff0000)":y="arrowred"}y&&(w.src="svg/"+y+".svg")}if(c.pid=[n,i.name],c.onclick=function(e){friends.sendApp(e,this.pid[0],this.pid[1])},t>=0){var S=s+t;if(0==t){var T=m.firstChild;T?m.insertBefore(c,T):m.appendChild(c)}else insertAfter(c,document.getElementById(S))}else m.appendChild(c);c.id=r}}}};